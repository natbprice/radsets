---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r setup, include=FALSE}
library(radsets)
library(tidyverse)
library(knitr)
local({
  hook_plot = knit_hooks$get('plot')
  knit_hooks$set(plot = function(x, options) {
    x = paste(x, collapse = '.')
    if (!grepl('\\.svg', x)) return(hook_plot(x, options))
    # read the content of the svg image and write it out without <?xml ... ?>
    paste0('<img src= "./', x, '">')
  })
})
```

```{r, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  echo = FALSE, 
  eval= TRUE,
  message = FALSE, 
  warning = FALSE,
  comment = "#>",
  fig.path = "README-"
)
```

### Overview

The **radsets** package creates Radial Sets diagrams for visualizing overlapping sets.  

```{r examplePlot, echo = FALSE, dev = 'svg', fig.width = 10, fig.height = 10}
# Load sample data
data("movieSets")

# Define set names (user specified)
setNames <- movieSets %>%
  select(Action:Western) %>%
  colnames()

# Define ID column (user specified)
idName <- "movieId"

# Define max degree (user specified)
maxDegree <- 4

# Calculate set sizes
setSizes <-
  getSetSizes(movieSets, setNames)

# Calculate set sizes by degree
setSizesByDegree <-
  getSetSizesByDegree(movieSets, setNames, idName)

# Calculate edge data
setIntersections <-
  getSetIntersections(movieSets, setNames, idName)

buildRadialSetsPlot(
  setSizes,
  setSizesByDegree,
  setIntersections,
  setOrder = c("Drama", "Romance", "Comedy", "Musical", "Animation", "Children", 
               "Fantasy", "Adventure", "Action", "War", "Sci-Fi", "Horror", 
               "Crime", "Thriller", "Mystery", "IMAX", "Western", "Film-Noir", 
               "Documentary"),
  disPropLim = c(-1, 1)
)
```

### When to use radial sets to visualize data
Radial sets are useful for visualizing relationships among variables which have many features in common. When the number of variables is small, simple venn diagrams can be useful (e.g. Figure \@ref(fig:venDiag)).

```{r vennDiag, fig.cap="Example of a simple overlapping set using a venn diagram."}
# install.packages("VennDiagram")
library(VennDiagram)
grid.newpage()
venn.plot <- draw.triple.venn(area1           = 4,
                              area2           = 3,
                              area3           = 4,
                              n12             = 2,
                              n23             = 2,
                              n13             = 2,
                              n123            = 1,
                              category        = c('A', 'B', 'C'),
                              fill            = c('red', 'blue', 'green'),
                              cat.col         = c('red', 'blue', 'green'),
                              cex             = c(1/2,2/2,3/2,4/2,5/2,6/2,7/2),
                              cat.cex         = c(1,2,3),
                              euler           = TRUE,
                              scaled          = FALSE
                             )
```
However, when the number of pairwise interactions is high, identifying patterns may be too difficult using simple visualizations (e.g., Fig. \@ref(fig:vennDiag2)). 
```{r vennDiag2, fig.cap="Example of a more complicated overlapping set using a venn diagram."}
grid.newpage()
venn.plot <- draw.quintuple.venn(
  area1 = 301,
    area2 = 321,
    area3 = 311,
    area4 = 321,
    area5 = 301,
    n12 = 188,
    n13 = 191,
    n14 = 184,
    n15 = 177,
    n23 = 194,
    n24 = 197,
    n25 = 190,
    n34 = 190,
    n35 = 173,
    n45 = 186,
    n123 = 112,
    n124 = 108,
    n125 = 108,
    n134 = 111,
    n135 = 104,
    n145 = 104,
    n234 = 111,
    n235 = 107,
    n245 = 110,
    n345 = 100,
    n1234 = 61,
    n1235 = 60,
    n1245 = 59,
    n1345 = 58,
    n2345 = 57,
    n12345 = 31,
    category = c("A", "B", "C", "D", "E"),
    # fill = c("dodgerblue", "goldenrod1", "darkorange1", "seagreen3", "orchid3"),
    # cat.col = c("dodgerblue", "goldenrod1", "darkorange1", "seagreen3", "orchid3"),
    cat.cex = 2,
    margin = 0.05,
    cex = c(1.5, 1.5, 1.5, 1.5, 1.5, 1, 0.8, 1, 0.8, 1, 0.8, 1, 0.8, 1, 0.8, 
    1, 0.55, 1, 0.55, 1, 0.55, 1, 0.55, 1, 0.55, 1, 1, 1, 1, 1, 1.5),
    ind = TRUE
    )
```
