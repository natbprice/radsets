---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r setup, include=FALSE}
library(radsets)
library(tidyverse)
library(knitr)
local({
  hook_plot = knit_hooks$get('plot')
  knit_hooks$set(plot = function(x, options) {
    x = paste(x, collapse = '.')
    if (!grepl('\\.svg', x)) return(hook_plot(x, options))
    # read the content of the svg image and write it out without <?xml ... ?>
    paste0('<img src= "./', x, '">')
  })
})
```

```{r, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  echo = FALSE, 
  eval= TRUE,
  message = FALSE, 
  warning = FALSE,
  comment = "#>",
  fig.path = "README-"
)
```

### Overview
The **radsets** package is a solution to the problem of how to visualize large overlapping sets. In particular, when analyzing data with many overlapping sets it is difficult to draw insight from a Venn diagram. Moreover, it may be impossible to draw a Venn diagram that accurately reflects the size of set intersections.

The solution implemented in the **radsets** package is a based on Radial Sets diagrams (see references). Radial Sets diagrams are an interactive, network-based visualization for the analysis of ovarlapping sets.

### MovieLens Example
#### Radial Sets Diagram
The [MovieLens dataset](https://grouplens.org/datasets/movielens/20m/) includes 
19 genre attributes for 27,000 movies. A Radial Sets diagram created with the **radsets** package is shown below. The width of the links indicate the percent overlap (normalized by union) between each movie genre. The link color indicates the relative difference between the observed overlap and the expected overlap assuming marginal independence. The link color palette is diverging blue to red with red indicating overlaps that are larger than expected. The bars in each sector indicate the number of items unique to each set, shared with one other set, shared with two other sets, or shared with three or more other sets. The set locations on the circumference have been optimized using the **radsets** package to place similar sets closer together, thereby minimizing length of thickest links.

```{r examplePlot, dev = 'svg', fig.width = 10, fig.height = 10}
# Load sample data
data("movieSets")

# Define set names (user specified)
setNames <- movieSets %>%
  select(Action:Western) %>%
  colnames()

# Define ID column (user specified)
idName <- "movieId"

# Define max degree (user specified)
maxDegree <- 4

# Calculate set sizes
setSizes <-
  getSetSizes(movieSets, setNames)

# Calculate set sizes by degree
setSizesByDegree <-
  getSetSizesByDegree(movieSets, setNames, idName)

# Calculate edge data
setIntersections <-
  getSetIntersections(movieSets, setNames, idName)

buildRadialSetsPlot(
  setSizes,
  setSizesByDegree,
  setIntersections,
  setOrder = c("Drama", "Romance", "Comedy", "Musical", "Animation", "Children", 
               "Fantasy", "Adventure", "Action", "War", "Sci-Fi", "Horror", 
               "Crime", "Thriller", "Mystery", "IMAX", "Western", "Film-Noir", 
               "Documentary"),
  colorScaleLim = c(-1, 1),
  maxPlotWidth = 10,
  linkColorPal = "RdBu",
  reverseLinkPal = "TRUE"
)
```

```{r examplePlot2, dev = 'svg', fig.width = 10, fig.height = 10}

buildRadialSetsPlot(
  setSizes,
  setSizesByDegree,
  setIntersections,
  focusSets = "Crime",
  linkThickness = "prop1",
  setOrder = c("Drama", "Romance", "Comedy", "Musical", "Animation", "Children", 
               "Fantasy", "Adventure", "Action", "War", "Sci-Fi", "Horror", 
               "Crime", "Thriller", "Mystery", "IMAX", "Western", "Film-Noir", 
               "Documentary"),
  colorScaleLim = c(-1, 1),
  maxPlotWidth = 10,
  linkColorPal = "RdBu",
  reverseLinkPal = "TRUE"
)
```

#### Venn Euler Diagram
Radial sets are useful for visualizing relationships among variables which have many features in common. When the number of variables is small, simple venn diagrams can be useful. However, when the number of pairwise interactions is high, identifying patterns may be too difficult using simple visualizations. Moreover, it may not be possible to draw a venn diagam that accurately represents the overlap between sets. Here we use the [venneuler](https://cran.r-project.org/package=venneuler) to illustrate the problem with using Venn diagrams when we are interested in many overlapping sets.


```{r simpleVennDiag, dev = 'svg'}

library(venneuler)

m <- movieSets %>% 
  select(movieId, setNames) %>% 
  select(-movieId) %>% 
  select("Drama", "Romance", "Comedy")
v <- venneuler::venneuler(m)
plot(v)

```


```{r complexVennDiag, dev = 'svg', fig.width = 7, fig.height = 7}

m <- movieSets %>% 
  select(movieId, setNames) %>% 
  select(-movieId)
v <- venneuler::venneuler(m)
plot(v)
```

## References
Radial Sets diagrams were originally proposed by Alsallakh, Aigner, Miksch, and Hauser. The **radsets** package is unaffiliated with these researchers and the visualizations produced differ from the original design.

Alsallakh, B., Aigner, W., Miksch, S., & Hauser, H. (2013). Radial sets: Interactive visual analysis of large overlapping sets. IEEE Transactions on Visualization and Computer Graphics, 19(12), 2496â€“2505. Retrieved from http://ieeexplore.ieee.org/abstract/document/6634104/
